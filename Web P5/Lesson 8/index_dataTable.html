<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/v/bs5/jq-3.6.0/jszip-2.5.0/dt-1.13.1/af-2.5.1/b-2.3.2/b-colvis-2.3.2/b-html5-2.3.2/b-print-2.3.2/cr-1.6.1/date-1.2.0/fc-4.2.1/fh-3.3.1/kt-2.8.0/r-2.4.0/rg-1.3.0/rr-1.3.1/sc-2.0.7/sb-1.4.0/sp-2.1.0/sl-1.5.0/sr-1.2.0/datatables.min.css"
    />

    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.datatables.net/v/bs5/jq-3.6.0/jszip-2.5.0/dt-1.13.1/af-2.5.1/b-2.3.2/b-colvis-2.3.2/b-html5-2.3.2/b-print-2.3.2/cr-1.6.1/date-1.2.0/fc-4.2.1/fh-3.3.1/kt-2.8.0/r-2.4.0/rg-1.3.0/rr-1.3.1/sc-2.0.7/sb-1.4.0/sp-2.1.0/sl-1.5.0/sr-1.2.0/datatables.min.js"
    ></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
      crossorigin="anonymous"
    ></script>
    <title>Lesson 6</title>
  </head>
  <body>
    <input type="file" id="fileUpload" class="form-control">
    <button id="submit" type="button" class="btn btn-light">Submit</button>
    <br>
    <br>
    <table id="covid" class="table"></table>
    <button id="load">Click me</button>
    <script>
      var columns = [];
      var rows = [];
      $("#submit").on("click", function(){
        var csv = $("#fileUpload")[0].files[0];
        var reader = new FileReader();
        reader.readAsText(csv);
        reader.addEventListener("load", () => {
          var result = reader.result;
          const array = result.split("\r\n");
            const temp = array[0].split(",");

            for (let i = 0; i < temp.length; i++) {
              columns.push(`<th>${temp[i]}</th>`);
            }
            $("#covid").append(`<thead><tr>${columns}</tr></thead>`);
            console.log(array.length);
            // console.log(array.length);
            for (let i = 1; i < array.length - 1; i++) {
              columns = [];
              newArray = array[i].split(",");
              rows.push(newArray);
            }
        });
                // Remeber to remove empty row!!!!!!!
        // Remeber to remove empty row!!!!!!!
        // Remeber to remove empty row!!!!!!!
        // $.ajax({
        //   success: function (result) {
        //     const array = result.split("\r\n");
        //     const temp = array[0].split(",");

        //     for (let i = 0; i < temp.length; i++) {
        //       columns.push(`<th>${temp[i]}</th>`);
        //     }
        //     $("#covid").append(`<thead><tr>${columns}</tr></thead>`);
        //     console.log(array.length);
        //     // console.log(array.length);
        //     for (let i = 1; i < array.length - 1; i++) {
        //       columns = [];
        //       newArray = array[i].split(",");
        //       rows.push(newArray);
        //     }
        //   },
        // });

        $("#covid").empty();
        $("#load").click(function () {
          $("#covid").dataTable({
            data: rows,
            dom: "<'d-flex gap-4'<P><'w-200'<'d-flex justify-content-between'f><t><'d-flex flex-row justify-content-between align-items-center'l<'mt-n1'i>p>>>",
          });
        });
        // $("#covid").dataTable({
        //   data: rows,
        // });
      });
    </script>
  </body>
</html>
